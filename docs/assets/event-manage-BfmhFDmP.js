import{c as ce,a as Ce,r as w,j as e,d as He,u as Xe,b as Ze,e as be,f as et,h as tt}from"./index-B2qNh-of.js";import{u as Y}from"./useQuery-B5p1eKko.js";import{u as V}from"./useMutation-VtAMB7Y8.js";import{u as st}from"./index.esm-C2MnXUms.js";import{B as u}from"./button-Cu0xg1s2.js";import{L as i,I as d}from"./label-D_vZlq4M.js";import{T as C}from"./textarea-CUejHJpB.js";import{C as p,a as v,b as y,c as g}from"./card-DsWjA9II.js";import{B as U}from"./badge-Ca-ejKI5.js";import{U as at,P as we}from"./upload-BTASZG0m.js";import{S as _}from"./sparkles-B_fWHyZl.js";import{M as Ie}from"./mail-9iXb1Lqm.js";import{B as ke}from"./building-2-DEJqXYl2.js";import{C as it}from"./circle-alert-DXlqVq-R.js";import{T as Fe}from"./trophy-B-9gRxaM.js";import{F as Se}from"./file-text-D57t4ljJ.js";import{C as Te}from"./clock-BKgWjb7Z.js";import{U as oe}from"./users-B7ByOmWN.js";import{S as W,a as H,b as X,c as Z,d as j}from"./select-BEEbH5Xa.js";import{T as nt,a as rt,b as R,c as O}from"./tabs-Cagqlvqf.js";import{T as lt,D as ot,a as ct,b as dt,c as mt,d as ht,e as xt}from"./dialog-CO8KtrrO.js";import{B as M}from"./brain-DtKyxrUK.js";import{A as ut}from"./arrow-left-0kxFHsKd.js";import{S as pt}from"./settings-3R0gGL-K.js";import{S as re,a as le}from"./square-pen-BrUnXSqg.js";import{C as gt}from"./calendar-ChqivEpW.js";import{M as jt}from"./map-pin-CbgDUv0E.js";import"./index-BdQq_4o_.js";import"./index-DH8JbX42.js";import"./Combination-DqKYv0MV.js";import"./chevron-up-Bu2wdl2L.js";import"./index-ArSVpY9-.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=[["circle",{cx:"16",cy:"4",r:"1",key:"1grugj"}],["path",{d:"m18 19 1-7-6 1",key:"r0i19z"}],["path",{d:"m5 8 3-3 5.5 3-2.36 3.5",key:"9ptxx2"}],["path",{d:"M4.24 14.5a5 5 0 0 0 6.88 6",key:"10kmtu"}],["path",{d:"M13.76 17.5a5 5 0 0 0-6.88-6",key:"2qq6rc"}]],yt=ce("accessibility",vt);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Ee=ce("palette",ft);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],bt=ce("share-2",Nt);function wt({event:r,onUpdate:m,isLoading:P}){const{toast:o}=Ce(),[b,T]=w.useState(!1),I=async c=>{T(!0);try{const l=await fetch(`/api/events/${r.id}/generate-copy`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:c}),credentials:"include"});if(!l.ok)throw new Error("Failed to generate copy");const E=await l.json();m({[c==="promotional"?"eventCopy":c==="welcome"?"welcomeMessage":c==="thankyou"?"thankYouMessage":"eventRules"]:E.copy}),o({title:"AI Copy Generated",description:`Generated ${c} content successfully!`})}catch{o({title:"Generation Failed",description:"Failed to generate AI copy. Please try again.",variant:"destructive"})}finally{T(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(at,{className:"w-5 h-5"}),"Visual Branding"]})}),e.jsx(g,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"logoUrl",children:"Event Logo URL"}),e.jsx(d,{id:"logoUrl",placeholder:"https://example.com/logo.png",value:r.logoUrl||"",onChange:c=>m({logoUrl:c.target.value}),"data-testid":"input-logo-url"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Upload your event logo for branding"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"backgroundImageUrl",children:"Background Image URL"}),e.jsx(d,{id:"backgroundImageUrl",placeholder:"https://example.com/background.jpg",value:r.backgroundImageUrl||"",onChange:c=>m({backgroundImageUrl:c.target.value}),"data-testid":"input-background-url"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Background image for event screens"})]})]})})]}),e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5"}),"Color Theme"]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"primaryColor",children:"Primary Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{id:"primaryColor",type:"color",value:r.primaryColor||"#7C2D12",onChange:c=>m({primaryColor:c.target.value}),className:"w-16 h-10 border rounded cursor-pointer","data-testid":"input-primary-color"}),e.jsx(d,{placeholder:"#7C2D12",value:r.primaryColor||"#7C2D12",onChange:c=>m({primaryColor:c.target.value}),className:"flex-1"})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"secondaryColor",children:"Secondary Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{id:"secondaryColor",type:"color",value:r.secondaryColor||"#FEF3C7",onChange:c=>m({secondaryColor:c.target.value}),className:"w-16 h-10 border rounded cursor-pointer","data-testid":"input-secondary-color"}),e.jsx(d,{placeholder:"#FEF3C7",value:r.secondaryColor||"#FEF3C7",onChange:c=>m({secondaryColor:c.target.value}),className:"flex-1"})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"fontFamily",children:"Font Family"}),e.jsx(d,{id:"fontFamily",placeholder:"Inter",value:r.fontFamily||"Inter",onChange:c=>m({fontFamily:c.target.value}),"data-testid":"input-font-family"})]})]}),e.jsx("div",{className:"p-4 border rounded-lg",style:{backgroundColor:r.secondaryColor||"#FEF3C7",fontFamily:r.fontFamily||"Inter"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-xl font-bold mb-2",style:{color:r.primaryColor||"#7C2D12"},children:r.title||"Your Event Title"}),e.jsx(U,{style:{backgroundColor:r.primaryColor||"#7C2D12",color:"white"},children:"Theme Preview"})]})})]})]}),e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5"}),"AI-Generated Content"]})}),e.jsxs(g,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(i,{htmlFor:"eventCopy",children:"Promotional Event Copy"}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:()=>I("promotional"),disabled:b,"data-testid":"button-generate-promotional",children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),b?"Generating...":"Generate"]})]}),e.jsx(C,{id:"eventCopy",placeholder:"AI will generate engaging promotional copy for your event...",value:r.eventCopy||"",onChange:c=>m({eventCopy:c.target.value}),rows:4,"data-testid":"textarea-event-copy"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(i,{htmlFor:"welcomeMessage",children:"Welcome Message"}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:()=>I("welcome"),disabled:b,"data-testid":"button-generate-welcome",children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),"Generate"]})]}),e.jsx(C,{id:"welcomeMessage",placeholder:"Welcome message shown to participants when they join...",value:r.welcomeMessage||"",onChange:c=>m({welcomeMessage:c.target.value}),rows:3,"data-testid":"textarea-welcome-message"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(i,{htmlFor:"thankYouMessage",children:"Thank You Message"}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:()=>I("thankyou"),disabled:b,"data-testid":"button-generate-thankyou",children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),"Generate"]})]}),e.jsx(C,{id:"thankYouMessage",placeholder:"Thank you message shown after event completion...",value:r.thankYouMessage||"",onChange:c=>m({thankYouMessage:c.target.value}),rows:3,"data-testid":"textarea-thank-you-message"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(i,{htmlFor:"eventRules",children:"Event Rules"}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:()=>I("rules"),disabled:b,"data-testid":"button-generate-rules",children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),"Generate"]})]}),e.jsx(C,{id:"eventRules",placeholder:"Clear rules and guidelines for participants...",value:r.eventRules||"",onChange:c=>m({eventRules:c.target.value}),rows:4,"data-testid":"textarea-event-rules"})]})]})]})]})}function Ct({event:r,onUpdate:m,isLoading:P}){const o=l=>{if(!l)return{};if(typeof l=="string")try{return JSON.parse(l)}catch{return{}}return typeof l=="object"?l??{}:{}},b=(l,E)=>{const ee={...o(r.socialLinks),[l]:E};m({socialLinks:JSON.stringify(ee)})},T=(l,E)=>{const ee={...o(r.sponsorInformation),[l]:E};m({sponsorInformation:JSON.stringify(ee)})},I=o(r.socialLinks),c=o(r.sponsorInformation);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"w-5 h-5"}),"Contact Information"]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"contactEmail",children:"Contact Email"}),e.jsx(d,{id:"contactEmail",type:"email",placeholder:"contact@example.com",value:r.contactEmail||"",onChange:l=>m({contactEmail:l.target.value}),"data-testid":"input-contact-email"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"contactPhone",children:"Contact Phone"}),e.jsx(d,{id:"contactPhone",type:"tel",placeholder:"+1 (555) 123-4567",value:r.contactPhone||"",onChange:l=>m({contactPhone:l.target.value}),"data-testid":"input-contact-phone"})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"websiteUrl",children:"Website URL"}),e.jsx(d,{id:"websiteUrl",type:"url",placeholder:"https://yourorganization.com",value:r.websiteUrl||"",onChange:l=>m({websiteUrl:l.target.value}),"data-testid":"input-website-url"})]})]})]}),e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(bt,{className:"w-5 h-5"}),"Social Media Links"]})}),e.jsx(g,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"facebook",children:"Facebook"}),e.jsx(d,{id:"facebook",placeholder:"https://facebook.com/yourpage",value:I.facebook||"",onChange:l=>b("facebook",l.target.value),"data-testid":"input-facebook"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"twitter",children:"Twitter/X"}),e.jsx(d,{id:"twitter",placeholder:"https://twitter.com/yourhandle",value:I.twitter||"",onChange:l=>b("twitter",l.target.value),"data-testid":"input-twitter"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"instagram",children:"Instagram"}),e.jsx(d,{id:"instagram",placeholder:"https://instagram.com/yourhandle",value:I.instagram||"",onChange:l=>b("instagram",l.target.value),"data-testid":"input-instagram"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"linkedin",children:"LinkedIn"}),e.jsx(d,{id:"linkedin",placeholder:"https://linkedin.com/company/yourorg",value:I.linkedin||"",onChange:l=>b("linkedin",l.target.value),"data-testid":"input-linkedin"})]})]})})]}),e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5"}),"Sponsor Information"]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"sponsorName",children:"Main Sponsor Name"}),e.jsx(d,{id:"sponsorName",placeholder:"Sponsor Company Name",value:c.name||"",onChange:l=>T("name",l.target.value),"data-testid":"input-sponsor-name"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"sponsorLogoUrl",children:"Sponsor Logo URL"}),e.jsx(d,{id:"sponsorLogoUrl",placeholder:"https://sponsor.com/logo.png",value:c.logoUrl||"",onChange:l=>T("logoUrl",l.target.value),"data-testid":"input-sponsor-logo"})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"sponsorWebsite",children:"Sponsor Website"}),e.jsx(d,{id:"sponsorWebsite",type:"url",placeholder:"https://sponsor.com",value:c.website||"",onChange:l=>T("website",l.target.value),"data-testid":"input-sponsor-website"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"sponsorDescription",children:"Sponsor Description"}),e.jsx(C,{id:"sponsorDescription",placeholder:"Brief description of the sponsor and their involvement...",value:c.description||"",onChange:l=>T("description",l.target.value),rows:3,"data-testid":"textarea-sponsor-description"})]})]})]}),e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(it,{className:"w-5 h-5"}),"Policies & Terms"]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"cancellationPolicy",children:"Cancellation Policy"}),e.jsx(C,{id:"cancellationPolicy",placeholder:"Explain your event cancellation policy...",value:r.cancellationPolicy||"",onChange:l=>m({cancellationPolicy:l.target.value}),rows:3,"data-testid":"textarea-cancellation-policy"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"refundPolicy",children:"Refund Policy"}),e.jsx(C,{id:"refundPolicy",placeholder:"Explain your refund policy for participants...",value:r.refundPolicy||"",onChange:l=>m({refundPolicy:l.target.value}),rows:3,"data-testid":"textarea-refund-policy"})]})]})]})]})}function It({event:r,onUpdate:m,isLoading:P}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5"}),"Prize Information"]})}),e.jsx(g,{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(i,{htmlFor:"prizeInformation",children:"Prize Details"}),e.jsx(C,{id:"prizeInformation",placeholder:"Describe the prizes and rewards for participants...",value:r.prizeInformation||"",onChange:o=>m({prizeInformation:o.target.value}),rows:4,"data-testid":"textarea-prize-information"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Detail what winners can expect to receive"})]})})]}),e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-5 h-5"}),"Event Instructions"]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"specialInstructions",children:"Special Instructions"}),e.jsx(C,{id:"specialInstructions",placeholder:"Any special instructions for participants...",value:r.specialInstructions||"",onChange:o=>m({specialInstructions:o.target.value}),rows:3,"data-testid":"textarea-special-instructions"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"technicalRequirements",children:"Technical Requirements"}),e.jsx(C,{id:"technicalRequirements",placeholder:"Device requirements, internet speed, software needed...",value:r.technicalRequirements||"",onChange:o=>m({technicalRequirements:o.target.value}),rows:3,"data-testid":"textarea-technical-requirements"})]})]})]}),e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-5 h-5"}),"Registration & Timing"]})}),e.jsx(g,{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(i,{htmlFor:"registrationDeadline",children:"Registration Deadline"}),e.jsx(d,{id:"registrationDeadline",type:"datetime-local",value:r.registrationDeadline?new Date(r.registrationDeadline).toISOString().slice(0,16):"",onChange:o=>m({registrationDeadline:o.target.value?new Date(o.target.value).toISOString():null}),"data-testid":"input-registration-deadline"})]})})]}),e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-5 h-5"}),"Participant Requirements"]})}),e.jsx(g,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"ageRestrictions",children:"Age Restrictions"}),e.jsx(d,{id:"ageRestrictions",placeholder:"e.g., 18+ or All ages welcome",value:r.ageRestrictions||"",onChange:o=>m({ageRestrictions:o.target.value}),"data-testid":"input-age-restrictions"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"dressCode",children:"Dress Code"}),e.jsx(d,{id:"dressCode",placeholder:"e.g., Business casual, Themed attire",value:r.dressCode||"",onChange:o=>m({dressCode:o.target.value}),"data-testid":"input-dress-code"})]})]})})]}),e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"w-5 h-5"}),"Accessibility & Accommodations"]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"accessibilityInfo",children:"Accessibility Information"}),e.jsx(C,{id:"accessibilityInfo",placeholder:"Accessibility features and accommodations available...",value:r.accessibilityInfo||"",onChange:o=>m({accessibilityInfo:o.target.value}),rows:3,"data-testid":"textarea-accessibility-info"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"dietaryAccommodations",children:"Dietary Accommodations"}),e.jsx(C,{id:"dietaryAccommodations",placeholder:"Food allergies, dietary restrictions, special meal options...",value:r.dietaryAccommodations||"",onChange:o=>m({dietaryAccommodations:o.target.value}),rows:3,"data-testid":"textarea-dietary-accommodations"})]})]})]}),e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-5 h-5"}),"Event Settings"]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"allowParticipants",checked:r.allowParticipants||!1,onChange:o=>m({allowParticipants:o.target.checked}),className:"rounded border-gray-300","data-testid":"checkbox-allow-participants","aria-describedby":"allowParticipants-description"}),e.jsx(i,{htmlFor:"allowParticipants",children:"Allow Participants"})]}),e.jsx("p",{id:"allowParticipants-description",className:"text-sm text-gray-500 mt-1",children:"When enabled, participants can join teams and compete in the trivia. When disabled, this becomes a content-focused presentation without participant interaction."})]})]})]})}console.log("event-manage.tsx module loaded!");function ls({eventId:r}={}){console.log("EventManage component is mounting!");const[,m]=He("/events/:id/manage");console.log("Route params:",m);const[,P]=Xe(),{toast:o}=Ce(),b=Ze(),[T,I]=w.useState(null),[c,l]=w.useState(!1),[E,G]=w.useState(""),[ee,kt]=w.useState(""),[de,De]=w.useState(!1),{data:Pe,isLoading:me,error:Le}=Y({queryKey:["/api/auth/me"],retry:!1}),N=r||m?.id;if(console.log("Extracted eventId:",N,"from propEventId:",r,"params:",m),console.log("EventManage - eventId:",N,"propEventId:",r,"params:",m),Le||!me&&!Pe)return P("/"),null;if(me)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-wine-50 to-champagne-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 wine-gradient rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(M,{className:"text-champagne-400 h-8 w-8 animate-pulse"})}),e.jsx("p",{className:"text-wine-700",children:"Loading..."})]})});if(!N)return console.error("No eventId provided to EventManage component"),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-wine-50 to-champagne-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 wine-gradient rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(M,{className:"text-champagne-400 h-8 w-8"})}),e.jsx("h1",{className:"text-2xl font-bold text-wine-800 mb-2",children:"Event Not Found"}),e.jsx("p",{className:"text-wine-600 mb-4",children:"No event ID was provided."}),e.jsx(u,{onClick:()=>P("/dashboard"),variant:"outline",children:"Return to Dashboard"})]})});const{data:s,isLoading:Ae,error:Ft}=Y({queryKey:["/api/events",N],enabled:!!N,retry:!1}),{data:ie=[],isLoading:St}=Y({queryKey:["/api/events",N,"questions"],enabled:!!N,retry:!1}),{data:ne=[],isLoading:Me}=Y({queryKey:["/api/events",N,"fun-facts"],enabled:!!N,retry:!1}),{register:z,handleSubmit:Ue,setValue:L,watch:te,reset:he,formState:{errors:Q,isDirty:ze}}=st({defaultValues:{title:s?.title||"",description:s?.description||"",eventType:s?.eventType||"",maxParticipants:s?.maxParticipants||50,difficulty:s?.difficulty||"mixed",eventDate:s?.eventDate?be(s.eventDate):"",eventTime:s?.eventTime||"",location:s?.location||"",sponsoringOrganization:s?.sponsoringOrganization||""}});w.useEffect(()=>{s&&(he({title:s.title||"",description:s.description||"",eventType:s.eventType||"",maxParticipants:s.maxParticipants||50,difficulty:s.difficulty||"mixed",eventDate:s.eventDate?be(s.eventDate):"",eventTime:s.eventTime||"",location:s.location||"",sponsoringOrganization:s.sponsoringOrganization||"",logoUrl:s.logoUrl||void 0,backgroundImageUrl:s.backgroundImageUrl||void 0,eventCopy:s.eventCopy||void 0,welcomeMessage:s.welcomeMessage||void 0,thankYouMessage:s.thankYouMessage||void 0,primaryColor:s.primaryColor||void 0,secondaryColor:s.secondaryColor||void 0,fontFamily:s.fontFamily||void 0,contactEmail:s.contactEmail||void 0,contactPhone:s.contactPhone||void 0,websiteUrl:s.websiteUrl||void 0,socialLinks:s.socialLinks||void 0,prizeInformation:s.prizeInformation||void 0,eventRules:s.eventRules||void 0,specialInstructions:s.specialInstructions||void 0,accessibilityInfo:s.accessibilityInfo||void 0,dietaryAccommodations:s.dietaryAccommodations||void 0,dressCode:s.dressCode||void 0,ageRestrictions:s.ageRestrictions||void 0,technicalRequirements:s.technicalRequirements||void 0,registrationDeadline:s.registrationDeadline||void 0,cancellationPolicy:s.cancellationPolicy||void 0,refundPolicy:s.refundPolicy||void 0,sponsorInformation:s.sponsorInformation||void 0,allowParticipants:s.allowParticipants||!1}),s.eventType&&L("eventType",s.eventType,{shouldValidate:!0,shouldDirty:!1}),setTimeout(()=>{!te("eventType")&&s.eventType&&L("eventType",s.eventType,{shouldValidate:!0,shouldDirty:!1})},50))},[s,he,L,te]);const $=V({mutationFn:async t=>{const n=await fetch(`/api/events/${N}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!n.ok)try{const f=await n.json();throw new Error(f.error||"Failed to update event")}catch{throw new Error("Failed to update event")}return n.json()},onSuccess:()=>{b.invalidateQueries({queryKey:["/api/events",N]}),o({title:"Event Updated",description:"Event details saved successfully."})},onError:t=>{o({title:"Update Failed",description:t.message||"An error occurred while saving the event.",variant:"destructive"})}}),J=V({mutationFn:async t=>{const n=await fetch(`/api/events/${N}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t}),credentials:"include"});if(!n.ok)try{const f=await n.json();throw new Error(f.error||"Failed to update status")}catch{throw new Error("Failed to update status")}return n.json()},onSuccess:()=>{b.invalidateQueries({queryKey:["/api/events",N]}),o({title:"Status Updated",description:"Event status changed."})},onError:t=>{o({title:"Status Update Failed",description:t.message||"Could not update event status.",variant:"destructive"})}}),qe=t=>{const n={...t,eventDate:t.eventDate?tt(t.eventDate,t.eventTime).toISOString():t.eventDate};$.mutate(n)};function Re({question:t,onSave:n,onCancel:f,isLoading:F}){const[h,D]=w.useState({question:t.question||"",correctAnswer:t.correctAnswer||"",options:Array.isArray(t.options)?[...t.options]:[],points:t.points||100,timeLimit:t.timeLimit||30,difficulty:t.difficulty||"medium",category:t.category||"",explanation:t.explanation||"",orderIndex:t.orderIndex||1,backgroundImageUrl:t.backgroundImageUrl||""}),[K,Qe]=w.useState(""),[pe,$e]=w.useState([]),[ge,je]=w.useState(!1),[ve,ye]=w.useState(null),[k,fe]=w.useState(null),[Be,Ne]=w.useState(!1),{data:S,refetch:Ve}=Y({queryKey:["/api/eventimages/question",t.id],queryFn:async()=>{const a=await fetch(`/api/eventimages/question/${t.id}`,{credentials:"include"});if(!a.ok)throw new Error("Failed to fetch event image");return a.json()}}),[A,q]=w.useState({unsplashImageId:"",sizeVariant:"regular",usageContext:"question_background",searchContext:""});w.useEffect(()=>{if(S?.eventImage){const a=S.eventImage;q({unsplashImageId:a.unsplashImageId||"",sizeVariant:a.sizeVariant||"regular",usageContext:a.usageContext||"question_background",searchContext:a.searchContext||""})}},[S]);const ae=V({mutationFn:async()=>{const a=await fetch(`/api/eventimages/question/${t.id}/replace`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(A),credentials:"include"});if(!a.ok){const x=await a.json();throw new Error(x.error||"Failed to save event image")}return a.json()},onSuccess:()=>{Ve(),o({title:"Event Image Saved",description:"Event image record has been saved successfully."})},onError:a=>{o({title:"Save Failed",description:a.message,variant:"destructive"})}}),Ge=(a,x)=>{const B=[...h.options];B[a]=x,D({...h,options:B})},Je=async()=>{if(K.trim()){je(!0),ye(null);try{const a=await fetch(`/api/unsplash/search?query=${encodeURIComponent(K)}&perPage=12`);if(!a.ok){const B=await a.json();throw new Error(B.error||"Search failed")}const x=await a.json();$e(x.results||[])}catch(a){ye(a.message)}finally{je(!1)}}},Ke=a=>{fe(a),D(x=>({...x,backgroundImageUrl:a.urls.regular})),q({unsplashImageId:a.id,sizeVariant:"regular",usageContext:"question_background",searchContext:K||""})},Ye=async()=>{if(k?.links?.download_location)try{Ne(!0),await fetch("/api/unsplash/track-download",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({downloadUrl:k.links.download_location})})}catch{}finally{Ne(!1)}},We=async()=>{console.log("handleSave called, selectedImage:",k);const a={...t,question:h.question,correctAnswer:h.correctAnswer,options:h.options,points:h.points,timeLimit:h.timeLimit,difficulty:h.difficulty,category:h.category,explanation:h.explanation,orderIndex:h.orderIndex,backgroundImageUrl:h.backgroundImageUrl||null};if(console.log("Calling onSave with question and selectedImage:",{question:a,selectedImage:k}),n(a,k||void 0),A.unsplashImageId){console.log("Saving EventImage record with form data:",A);try{await ae.mutateAsync()}catch(x){console.error("Failed to save EventImage record:",x)}}Ye()};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Question"}),e.jsx(C,{value:h.question,onChange:a=>D({...h,question:a.target.value}),className:"mt-1",rows:3,"data-testid":"textarea-edit-question"})]}),t.type==="multiple_choice"&&e.jsxs("div",{children:[e.jsx(i,{children:"Options"}),e.jsx("div",{className:"space-y-2 mt-1",children:h.options.map((a,x)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"w-8 h-10 bg-gray-100 rounded flex items-center justify-center text-sm font-medium",children:String.fromCharCode(65+x)}),e.jsx(d,{value:a,onChange:B=>Ge(x,B.target.value),placeholder:`Option ${String.fromCharCode(65+x)}`,"data-testid":`input-edit-option-${x}`})]},x))})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Correct Answer"}),e.jsx(d,{value:h.correctAnswer,onChange:a=>D({...h,correctAnswer:a.target.value}),className:"mt-1","data-testid":"input-edit-correct-answer"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Points"}),e.jsx(d,{type:"number",value:h.points,onChange:a=>D({...h,points:parseInt(a.target.value)||0}),className:"mt-1",min:10,max:500,"data-testid":"input-edit-points"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Time Limit (s)"}),e.jsx(d,{type:"number",value:h.timeLimit,onChange:a=>D({...h,timeLimit:parseInt(a.target.value)||30}),className:"mt-1",min:5,max:300,"data-testid":"input-edit-timeLimit"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Difficulty"}),e.jsxs(W,{value:h.difficulty,onValueChange:a=>D({...h,difficulty:a}),children:[e.jsx(H,{className:"mt-1","data-testid":"select-edit-difficulty",children:e.jsx(X,{})}),e.jsxs(Z,{children:[e.jsx(j,{value:"easy",children:"Easy"}),e.jsx(j,{value:"medium",children:"Medium"}),e.jsx(j,{value:"hard",children:"Hard"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Category"}),e.jsx(d,{value:h.category,onChange:a=>D({...h,category:a.target.value}),className:"mt-1",placeholder:"wine, geography, etc","data-testid":"input-edit-category"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Order #"}),e.jsx(d,{type:"number",value:h.orderIndex,onChange:a=>D({...h,orderIndex:parseInt(a.target.value)||1}),className:"mt-1",min:1,"data-testid":"input-edit-orderIndex"})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Explanation (shown after answering)"}),e.jsx(C,{value:h.explanation,onChange:a=>D({...h,explanation:a.target.value}),rows:3,className:"mt-1","data-testid":"textarea-edit-explanation"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Background Image"}),h.backgroundImageUrl&&e.jsx(u,{type:"button",variant:"outline",size:"sm",onClick:()=>{D({...h,backgroundImageUrl:""}),fe(null)},"data-testid":"button-remove-image",children:"Remove"})]}),h.backgroundImageUrl?e.jsx("div",{className:"relative",children:e.jsx("img",{src:h.backgroundImageUrl,alt:"Selected background",className:"rounded-md w-full h-40 object-cover border","data-testid":"image-selected-preview"})}):e.jsx("p",{className:"text-sm text-gray-500",children:"No image selected."}),e.jsxs("div",{className:"border rounded-md p-3 space-y-3 bg-gray-50",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{placeholder:"Search Unsplash (e.g., Oregon coast)",value:K,onChange:a=>Qe(a.target.value),"data-testid":"input-unsplash-query"}),e.jsx(u,{type:"button",onClick:Je,disabled:ge,"data-testid":"button-unsplash-search",children:ge?"Searching...":"Search"})]}),ve&&e.jsx("p",{className:"text-sm text-red-600","data-testid":"error-unsplash",children:ve}),pe.length>0&&e.jsx("div",{className:"grid grid-cols-4 gap-2 max-h-48 overflow-y-auto","data-testid":"grid-unsplash-results",children:pe.map((a,x)=>e.jsxs("button",{type:"button",onClick:()=>Ke(a),className:`group relative border rounded-md overflow-hidden focus:outline-none ${k?.id===a.id?"ring-2 ring-wine-500":"hover:ring-2 hover:ring-wine-300"}`,"data-testid":`unsplash-result-${x}`,children:[e.jsx("img",{src:a.urls.thumb,alt:a.alt_description||a.description||"img",className:"w-full h-16 object-cover"}),k?.id===a.id&&e.jsx("span",{className:"absolute inset-0 bg-wine-600/40 flex items-center justify-center text-white text-xs font-medium",children:"Selected"})]},a.id))}),k&&e.jsxs("p",{className:"text-[11px] text-gray-600","data-testid":"text-unsplash-attribution",children:["Photo by ",e.jsx("a",{className:"underline",target:"_blank",rel:"noreferrer",href:`${k.user.links.html}?utm_source=TriviaSpark&utm_medium=referral`,children:k.user.name})," on ",e.jsx("a",{className:"underline",target:"_blank",rel:"noreferrer",href:`${k.links.html}?utm_source=TriviaSpark&utm_medium=referral`,children:"Unsplash"})]})]})]}),e.jsxs(p,{className:"mt-4 border-2 border-wine-300",children:[e.jsxs(v,{className:"pb-3 bg-wine-50",children:[e.jsx(y,{className:"text-sm font-medium text-wine-800",children:"ðŸ–¼ï¸ Event Image Management"}),e.jsx("p",{className:"text-xs text-wine-600",children:"Configure and manage image metadata for this question"})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"unsplashImageId",className:"text-xs",children:"Unsplash Image ID"}),e.jsx(d,{id:"unsplashImageId",value:A.unsplashImageId,onChange:a=>q(x=>({...x,unsplashImageId:a.target.value})),placeholder:"Enter Unsplash image ID",className:"text-xs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"sizeVariant",className:"text-xs",children:"Size Variant"}),e.jsxs(W,{value:A.sizeVariant,onValueChange:a=>q(x=>({...x,sizeVariant:a})),children:[e.jsx(H,{className:"text-xs",children:e.jsx(X,{placeholder:"Select size"})}),e.jsxs(Z,{children:[e.jsx(j,{value:"thumb",children:"Thumb"}),e.jsx(j,{value:"small",children:"Small"}),e.jsx(j,{value:"regular",children:"Regular"}),e.jsx(j,{value:"full",children:"Full"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"usageContext",className:"text-xs",children:"Usage Context"}),e.jsxs(W,{value:A.usageContext,onValueChange:a=>q(x=>({...x,usageContext:a})),children:[e.jsx(H,{className:"text-xs",children:e.jsx(X,{placeholder:"Select usage"})}),e.jsxs(Z,{children:[e.jsx(j,{value:"question_background",children:"Question Background"}),e.jsx(j,{value:"event_banner",children:"Event Banner"}),e.jsx(j,{value:"category_icon",children:"Category Icon"}),e.jsx(j,{value:"promotional_material",children:"Promotional Material"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"searchContext",className:"text-xs",children:"Search Context"}),e.jsx(d,{id:"searchContext",value:A.searchContext,onChange:a=>q(x=>({...x,searchContext:a.target.value})),placeholder:"Search terms used",className:"text-xs"})]})]}),S?.eventImage&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx(i,{className:"text-xs font-medium text-muted-foreground",children:"Current Image Info"}),e.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-xs text-muted-foreground",children:[e.jsxs("div",{children:["Created: ",new Date(S.eventImage.createdAt).toLocaleString()]}),e.jsxs("div",{children:["Downloaded: ",S.eventImage.downloadTracked?"Yes":"No"]}),S.eventImage.attributionText&&e.jsxs("div",{className:"col-span-2",children:["Attribution: ",e.jsx("a",{href:S.eventImage.attributionUrl,target:"_blank",rel:"noopener noreferrer",className:"text-wine-600 hover:underline",children:S.eventImage.attributionText})]}),S.eventImage.imageUrl&&e.jsx("div",{className:"col-span-2",children:e.jsx("img",{src:S.eventImage.thumbnailUrl||S.eventImage.imageUrl,alt:"Current image",className:"w-16 h-16 object-cover rounded border"})})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(u,{type:"button",variant:"outline",size:"sm",onClick:()=>{k&&q({unsplashImageId:k.id,sizeVariant:"regular",usageContext:"question_background",searchContext:K||""})},disabled:!k,className:"text-xs",children:"Populate from Selected Image"}),e.jsx(u,{type:"button",size:"sm",onClick:()=>ae.mutate(),disabled:ae.isPending||!A.unsplashImageId,className:"text-xs",children:ae.isPending?"Saving...":"Save Image Record"})]})]})]}),e.jsxs(xt,{className:"pt-2",children:[e.jsx(u,{onClick:We,disabled:F||Be,className:"flex-1","data-testid":"button-save-question",children:F?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"mr-2 h-4 w-4 animate-pulse"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Save Changes"]})}),e.jsx(u,{onClick:f,variant:"outline",disabled:F,"data-testid":"button-cancel-edit",children:"Cancel"})]})]})}const se=t=>{J.mutate(t)},Oe=V({mutationFn:async({topic:t,type:n})=>{const f=await fetch("/api/questions/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({eventId:N,topic:t,type:n,count:1}),credentials:"include"});if(!f.ok){const F=await f.json();throw new Error(F.error||"Failed to generate question")}return f.json()},onSuccess:()=>{b.invalidateQueries({queryKey:["/api/events",N,"questions"]}),G(""),o({title:"Question Generated",description:"AI question has been added to your event."})},onError:t=>{o({title:"Generation Failed",description:t.message,variant:"destructive"})}}),xe=V({mutationFn:async({question:t,selectedImage:n})=>{const f={question:t.question,type:t.type,options:t.options,correctAnswer:t.correctAnswer,difficulty:t.difficulty,category:t.category,explanation:t.explanation,timeLimit:t.timeLimit,orderIndex:t.orderIndex,aiGenerated:t.aiGenerated,backgroundImageUrl:t.backgroundImageUrl};n?(console.log("Adding selectedImage to request:",n),f.selectedImage={id:n.id,author:n.user.name,authorUrl:n.user.links.html,photoUrl:n.urls.regular,downloadUrl:n.links.download_location||""},console.log("Final requestBody.selectedImage:",f.selectedImage)):console.log("No selectedImage provided to mutation"),console.log("Sending PUT request with body:",f);const F=await fetch(`/api/questions/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(f),credentials:"include"});if(!F.ok){const h=await F.json();throw new Error(h.error||"Failed to update question")}return F.json()},onSuccess:()=>{b.invalidateQueries({queryKey:["/api/events",N,"questions"]}),I(null),o({title:"Question Updated",description:"Question has been saved successfully."})},onError:t=>{o({title:"Update Failed",description:t.message,variant:"destructive"})}}),_e=V({mutationFn:async t=>{const n=await fetch(`/api/questions/${t}`,{method:"DELETE",credentials:"include"});if(!n.ok){const f=await n.json();throw new Error(f.error||"Failed to delete question")}},onSuccess:()=>{b.invalidateQueries({queryKey:["/api/events",N,"questions"]}),o({title:"Question Deleted",description:"Question has been removed from your event."})},onError:t=>{o({title:"Delete Failed",description:t.message,variant:"destructive"})}}),ue=t=>{if(!E.trim()){o({title:"Topic Required",description:"Please enter a topic for the AI question.",variant:"destructive"});return}l(!0),Oe.mutate({topic:E,type:t},{onSettled:()=>l(!1)})};return Ae?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-wine-50 to-champagne-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 wine-gradient rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(M,{className:"text-champagne-400 h-8 w-8 animate-pulse"})}),e.jsx("p",{className:"text-wine-700",children:"Loading event..."})]})}):s?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-wine-50 to-champagne-50",children:[e.jsx("div",{className:"wine-gradient shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs(u,{variant:"ghost",onClick:()=>P("/dashboard"),className:"text-white hover:bg-white/10 mr-4","data-testid":"button-back",children:[e.jsx(ut,{className:"mr-2 h-4 w-4"}),"Back"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white","data-testid":"text-page-title",children:"Manage Event"}),e.jsx("p",{className:"text-champagne-200","data-testid":"text-event-title",children:s.title})]})]}),e.jsx(U,{variant:s.status==="active"?"default":"secondary",className:`text-sm ${s.status==="active"?"bg-emerald-100 text-emerald-800":""}`,"data-testid":"badge-event-status",children:s.status})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs(nt,{defaultValue:"details",className:"space-y-6",children:[e.jsxs(rt,{className:"grid w-full grid-cols-7","data-testid":"tabs-event-management",children:[e.jsxs(R,{value:"details","data-testid":"tab-details",children:[e.jsx(pt,{className:"mr-2 h-4 w-4"}),"Details"]}),e.jsxs(R,{value:"branding","data-testid":"tab-branding",children:[e.jsx(Ee,{className:"mr-2 h-4 w-4"}),"Branding"]}),e.jsxs(R,{value:"event-info","data-testid":"tab-event-info",children:[e.jsx(Se,{className:"mr-2 h-4 w-4"}),"Event Info"]}),e.jsxs(R,{value:"contact","data-testid":"tab-contact",children:[e.jsx(Ie,{className:"mr-2 h-4 w-4"}),"Contact"]}),e.jsxs(R,{value:"trivia","data-testid":"tab-trivia",children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),"Trivia"]}),e.jsxs(R,{value:"funfacts","data-testid":"tab-funfacts",children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Fun Facts"]}),e.jsxs(R,{value:"status","data-testid":"tab-status",children:[e.jsx(Fe,{className:"mr-2 h-4 w-4"}),"Status"]})]}),e.jsx(O,{value:"branding",children:e.jsx(wt,{event:s,onUpdate:t=>{Object.keys(t).forEach(n=>{L(n,t[n])})},isLoading:$.isPending})}),e.jsx(O,{value:"event-info",children:e.jsx(It,{event:s,onUpdate:t=>{Object.keys(t).forEach(n=>{L(n,t[n])})},isLoading:$.isPending})}),e.jsx(O,{value:"contact",children:e.jsx(Ct,{event:s,onUpdate:t=>{Object.keys(t).forEach(n=>{L(n,t[n])})},isLoading:$.isPending})}),e.jsx(O,{value:"details",children:e.jsxs(p,{className:"trivia-card","data-testid":"card-event-details",children:[e.jsx(v,{children:e.jsx(y,{className:"wine-text",children:"Edit Event Details"})}),e.jsx(g,{children:e.jsxs("form",{onSubmit:Ue(qe),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(i,{htmlFor:"title",children:"Event Title *"}),e.jsx(d,{id:"title",...z("title",{required:"Title is required"}),className:"mt-1","data-testid":"input-title"}),Q.title&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:Q.title.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(i,{htmlFor:"description",children:"Description"}),e.jsx(C,{id:"description",...z("description"),rows:3,className:"mt-1","data-testid":"input-description"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"eventType",children:"Event Type *"}),e.jsxs(W,{value:te("eventType")||"",onValueChange:t=>{L("eventType",t,{shouldDirty:!0,shouldValidate:!0})},children:[e.jsx(H,{className:"mt-1","data-testid":"select-event-type",children:e.jsx(X,{placeholder:"Select event type"})}),e.jsxs(Z,{children:[e.jsx(j,{value:"wine-dinner",children:"Wine Dinner"}),e.jsx(j,{value:"corporate",children:"Corporate Event"}),e.jsx(j,{value:"party",children:"Party"}),e.jsx(j,{value:"educational",children:"Educational"}),e.jsx(j,{value:"fundraiser",children:"Fundraiser"})]})]}),Q.eventType&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:Q.eventType.message})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"difficulty",children:"Difficulty"}),e.jsxs(W,{value:te("difficulty")||"",onValueChange:t=>L("difficulty",t,{shouldDirty:!0}),children:[e.jsx(H,{className:"mt-1","data-testid":"select-difficulty",children:e.jsx(X,{placeholder:"Select difficulty"})}),e.jsxs(Z,{children:[e.jsx(j,{value:"easy",children:"Easy"}),e.jsx(j,{value:"medium",children:"Medium"}),e.jsx(j,{value:"hard",children:"Hard"}),e.jsx(j,{value:"mixed",children:"Mixed"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"maxParticipants",children:"Max Participants"}),e.jsx(d,{id:"maxParticipants",type:"number",...z("maxParticipants",{required:"Max participants is required",min:{value:1,message:"Must be at least 1"},max:{value:500,message:"Maximum 500 participants"},valueAsNumber:!0}),className:"mt-1","data-testid":"input-max-participants"}),Q.maxParticipants&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:Q.maxParticipants.message})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"eventDate",children:"Event Date"}),e.jsx(d,{id:"eventDate",type:"date",...z("eventDate"),className:"mt-1","data-testid":"input-event-date"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"eventTime",children:"Event Time"}),e.jsx(d,{id:"eventTime",...z("eventTime"),placeholder:"e.g., 7:00 PM",className:"mt-1","data-testid":"input-event-time"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"location",children:"Location"}),e.jsx(d,{id:"location",...z("location"),placeholder:"Event venue",className:"mt-1","data-testid":"input-location"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"sponsoringOrganization",children:"Sponsoring Organization"}),e.jsx(d,{id:"sponsoringOrganization",...z("sponsoringOrganization"),placeholder:"Organization name",className:"mt-1","data-testid":"input-sponsoring-org"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(u,{type:"submit",disabled:$.isPending||!ze,className:"trivia-button-primary","data-testid":"button-save-event",children:$.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin mr-2 h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Save Changes"]})})})]})})]})}),e.jsx(O,{value:"trivia",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(p,{className:"trivia-card","data-testid":"card-ai-generation",children:[e.jsx(v,{children:e.jsxs(y,{className:"wine-text flex items-center",children:[e.jsx(_,{className:"mr-2 h-5 w-5"}),"AI Question Generator"]})}),e.jsx(g,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"aiTopic",children:"Topic"}),e.jsx(d,{id:"aiTopic",value:E,onChange:t=>G(t.target.value),placeholder:"e.g., Pacific Northwest wines, Local history, Sports trivia",className:"mt-1","data-testid":"input-ai-topic"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(u,{onClick:()=>ue("multiple_choice"),disabled:c||!E.trim(),variant:"outline",className:"flex-1","data-testid":"button-generate-multiple-choice",children:[c?e.jsx(M,{className:"mr-2 h-4 w-4 animate-pulse"}):e.jsx(we,{className:"mr-2 h-4 w-4"}),"Multiple Choice"]}),e.jsxs(u,{onClick:()=>ue("true_false"),disabled:c||!E.trim(),variant:"outline",className:"flex-1","data-testid":"button-generate-true-false",children:[c?e.jsx(M,{className:"mr-2 h-4 w-4 animate-pulse"}):e.jsx(we,{className:"mr-2 h-4 w-4"}),"True/False"]})]})]})})]}),e.jsxs(p,{className:"trivia-card","data-testid":"card-questions-list",children:[e.jsx(v,{children:e.jsxs(y,{className:"wine-text flex items-center justify-between",children:[e.jsxs("span",{children:["Event Questions (",ie.length,")"]}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>P(`/events/${N}/manage/trivia`),"data-testid":"button-full-trivia-manage",className:"ml-4",children:"Open Full Manager"})]})}),e.jsx(g,{children:ie.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(M,{className:"mx-auto h-12 w-12 mb-4 text-gray-400"}),e.jsx("p",{className:"mb-2",children:"No questions yet"}),e.jsx("p",{className:"text-sm",children:"Generate AI questions or add your own to get started"})]}):e.jsx("div",{className:"space-y-4",children:ie.map((t,n)=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors","data-testid":`question-${n}`,children:e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(U,{variant:"secondary",className:"text-xs",children:["#",n+1]}),e.jsx(U,{variant:"outline",className:"text-xs",children:t.type.replace("_"," ")}),t.aiGenerated&&e.jsxs(U,{variant:"outline",className:"text-xs bg-blue-50 text-blue-600",children:[e.jsx(M,{className:"mr-1 h-3 w-3"}),"AI"]}),e.jsxs(U,{variant:"outline",className:"text-xs",children:[t.points||100," pts"]}),e.jsxs(U,{variant:"outline",className:"text-xs",children:[t.timeLimit,"s"]})]}),e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:t.question}),Array.isArray(t.options)&&t.options.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-2",children:t.options.map((f,F)=>e.jsxs("div",{className:`text-sm p-2 rounded ${f===t.correctAnswer?"bg-green-100 text-green-800 font-medium":"bg-gray-100 text-gray-700"}`,children:[String.fromCharCode(65+F),". ",f]},F))}),e.jsxs("p",{className:"text-sm text-green-600 font-medium",children:["Correct Answer: ",t.correctAnswer]}),t.explanation&&e.jsx("p",{className:"text-xs text-gray-500 line-clamp-2",children:t.explanation})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsxs(u,{onClick:()=>P(`/events/${s.id}/manage/trivia/${t.id}`),variant:"outline",size:"sm",className:"text-wine-600 border-wine-300 hover:bg-wine-50","data-testid":`button-edit-full-${n}`,children:[e.jsx(le,{className:"h-4 w-4 mr-1"}),"Edit with Image Form"]}),e.jsx(u,{onClick:()=>I(t),variant:"ghost",size:"sm","data-testid":`button-edit-${n}`,children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(u,{onClick:()=>{confirm("Are you sure you want to delete this question?")&&_e.mutate(t.id)},variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50","data-testid":`button-delete-${n}`,children:e.jsx(lt,{className:"h-4 w-4"})})]})]})})},t.id))})})]}),e.jsx(ot,{open:!!T,onOpenChange:t=>{t||I(null)},children:e.jsx(ct,{className:"max-w-3xl","data-testid":"dialog-edit-question",children:T&&e.jsxs(e.Fragment,{children:[e.jsxs(dt,{children:[e.jsx(mt,{children:"Edit Question"}),e.jsx(ht,{children:"Modify question content, scoring, ordering, and optional background image."})]}),e.jsx(Re,{question:T,onSave:(t,n)=>xe.mutate({question:t,selectedImage:n}),onCancel:()=>I(null),isLoading:xe.isPending})]})})})]})}),e.jsx(O,{value:"status",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(p,{className:"trivia-card","data-testid":"card-status-control",children:[e.jsx(v,{children:e.jsx(y,{className:"wine-text",children:"Event Status"})}),e.jsxs(g,{className:"space-y-4",children:[e.jsx("div",{className:"text-center",children:e.jsx(U,{variant:s.status==="active"?"default":"secondary",className:`text-lg px-4 py-2 ${s.status==="active"?"bg-emerald-100 text-emerald-800":""}`,"data-testid":"badge-current-status",children:(s.status||"draft").toUpperCase()})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(u,{onClick:()=>se("draft"),disabled:s.status==="draft"||J.isPending,variant:s.status==="draft"?"default":"outline","data-testid":"button-set-draft",children:"Draft"}),e.jsx(u,{onClick:()=>se("active"),disabled:s.status==="active"||J.isPending,variant:s.status==="active"?"default":"outline","data-testid":"button-set-active",children:"Active"}),e.jsx(u,{onClick:()=>se("completed"),disabled:s.status==="completed"||J.isPending,variant:s.status==="completed"?"default":"outline","data-testid":"button-set-completed",children:"Completed"}),e.jsx(u,{onClick:()=>se("cancelled"),disabled:s.status==="cancelled"||J.isPending,variant:s.status==="cancelled"?"destructive":"outline","data-testid":"button-set-cancelled",children:"Cancelled"})]})]})]}),e.jsxs(p,{className:"trivia-card","data-testid":"card-event-info",children:[e.jsx(v,{children:e.jsx(y,{className:"wine-text",children:"Event Information"})}),e.jsx(g,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(gt,{className:"mr-3 h-4 w-4 text-wine-600"}),e.jsx("span",{className:"font-medium",children:"Date:"}),e.jsx("span",{className:"ml-2","data-testid":"text-info-date",children:s.eventDate?et(s.eventDate):"Not set"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(Te,{className:"mr-3 h-4 w-4 text-wine-600"}),e.jsx("span",{className:"font-medium",children:"Time:"}),e.jsx("span",{className:"ml-2","data-testid":"text-info-time",children:s.eventTime||"Not set"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(jt,{className:"mr-3 h-4 w-4 text-wine-600"}),e.jsx("span",{className:"font-medium",children:"Location:"}),e.jsx("span",{className:"ml-2","data-testid":"text-info-location",children:s.location||"Not set"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(ke,{className:"mr-3 h-4 w-4 text-wine-600"}),e.jsx("span",{className:"font-medium",children:"Organization:"}),e.jsx("span",{className:"ml-2","data-testid":"text-info-organization",children:s.sponsoringOrganization||"Not set"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(oe,{className:"mr-3 h-4 w-4 text-wine-600"}),e.jsx("span",{className:"font-medium",children:"Max Participants:"}),e.jsx("span",{className:"ml-2","data-testid":"text-info-max-participants",children:s.maxParticipants})]})]})})]})]})}),e.jsx(O,{value:"funfacts",children:e.jsxs(p,{className:"trivia-card","data-testid":"card-fun-facts",children:[e.jsx(v,{children:e.jsxs(y,{className:"wine-text flex items-center justify-between",children:[e.jsx("span",{children:"Fun Facts Management"}),e.jsxs(u,{onClick:()=>De(!de),variant:"outline","data-testid":"button-edit-fun-facts",children:[e.jsx(le,{className:"mr-2 h-4 w-4"}),de?"Cancel":"Edit"]})]})}),e.jsx(g,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600",children:"Add fun facts about your organization that will be shown between questions during the trivia event."}),Me?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-wine-600"})}):e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("h4",{className:"font-medium mb-2",children:["Current Fun Facts (",ne.length,"):"]}),ne.length>0?e.jsx("div",{className:"space-y-3",children:ne.map((t,n)=>e.jsxs("div",{className:"border-l-4 border-wine-600 pl-3",children:[e.jsxs("h5",{className:"font-medium text-wine-700",children:[n+1,". ",t.title]}),e.jsx("p",{className:"text-gray-700 mt-1",children:t.content})]},t.id))}):e.jsx("p",{className:"text-gray-500",children:"No fun facts available for this event yet."})]})]})})]})})]})})]}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-wine-50 to-champagne-50 flex items-center justify-center",children:e.jsx(p,{className:"max-w-md w-full",children:e.jsxs(g,{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Event not found"}),e.jsx(u,{onClick:()=>P("/dashboard"),"data-testid":"button-back-events",children:"Back to Dashboard"})]})})})}export{ls as default};
